<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>í¬ì¼“ëª¬ ê´€ë¦¬</title>
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f4f4f4;
            padding: 20px;
        }
        h2 {
            text-align: center;
        }
        .container {
            max-width: 650px;
            margin: auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        input, select {
            padding: 10px;
            margin: 5px;
            width: calc(50% - 12px);
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        button {
            padding: 10px;
            margin: 5px 0;
            width: 100%;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
        .result {
            margin-top: 20px;
            padding: 10px;
            background: #eef;
            border-radius: 4px;
        }
        .pokemon-list li {
            padding: 4px;
            border-bottom: 1px solid #ccc;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>ğŸ§© í™•ì¥ëœ í¬ì¼“ëª¬ ê´€ë¦¬</h2>

        <!-- ì •ë ¬ ë° ëª©ë¡ -->
        <div>
            <select id="sortSelect">
                <option value="">ì •ë ¬ ì—†ìŒ</option>
                <option value="name">ì´ë¦„ìˆœ</option>
                <option value="hp">HPìˆœ</option>
                <option value="level">ë ˆë²¨ìˆœ</option>
            </select>
            <button onclick="fetchPokemonList()">ëª©ë¡ ì¡°íšŒ</button>
            <ul id="pokemonList" class="pokemon-list"></ul>
        </div>

        <hr>

        <!-- ë“±ë¡ -->
        <h4>ğŸ“¦ í¬ì¼“ëª¬ ë“±ë¡</h4>
        <input type="text" id="newName" placeholder="ì´ë¦„ ì…ë ¥" />
        <input type="text" id="newType" placeholder="íƒ€ì… ì…ë ¥ (ì˜ˆ: ë¶ˆ, ë¬¼)" />
        <input type="number" id="newHp" placeholder="HP ì…ë ¥" />
        <input type="number" id="newAttack" placeholder="ê³µê²©ë ¥ ì…ë ¥" />
        <input type="number" id="newDefense" placeholder="ë°©ì–´ë ¥ ì…ë ¥" />
        <input type="number" id="newSpeed" placeholder="ìŠ¤í”¼ë“œ ì…ë ¥" />
        <button onclick="registerPokemon()">ë“±ë¡</button>

        <hr>

        <!-- ê³µê²© -->
        <h4>âš”ï¸ í¬ì¼“ëª¬ ê³µê²©</h4>
        <input type="number" id="attackerId" placeholder="ê³µê²©ì ID" />
        <input type="number" id="defenderId" placeholder="ë°©ì–´ì ID" />
        <button onclick="attackPokemon()">ê³µê²©!</button>

        <hr>

        <!-- ì‚­ì œ -->
        <h4>ğŸ—‘ï¸ í¬ì¼“ëª¬ ì‚­ì œ</h4>
        <input type="number" id="deleteId" placeholder="ì‚­ì œí•  í¬ì¼“ëª¬ ID" />
        <button onclick="deletePokemon()">ì‚­ì œ</button>

        <!-- ê²°ê³¼ ì¶œë ¥ -->
        <div id="resultArea" class="result"></div>
    </div>

    <script>
      const baseUrl = "http://localhost:9001/api/v1/pokemon";

      // í¬ì¼“ëª¬ ëª©ë¡ ì¡°íšŒ
      async function fetchPokemonList() {
        const sort = document.getElementById("sortSelect").value;
        const res = await fetch(`${baseUrl}${sort ? `?sort=${sort}` : ""}`);
        const data = await res.json();
        const listEl = document.getElementById("pokemonList");
        listEl.innerHTML = "";
        data.forEach(pokemon => {
          const li = document.createElement("li");
          li.textContent = `ID: ${pokemon.id}, ì´ë¦„: ${pokemon.name}, íƒ€ì…: ${pokemon.type1}, HP: ${pokemon.hp}, ê³µê²©ë ¥: ${pokemon.attack}, ë°©ì–´ë ¥: ${pokemon.defense}`;
          listEl.appendChild(li);
        });
      }

      // ë“±ë¡
      async function registerPokemon() {
        const name = document.getElementById("newName").value;
        const type1 = document.getElementById("newType").value;
        const hp = document.getElementById("newHp").value;
        const attack = document.getElementById("newAttack").value;
        const defense = document.getElementById("newDefense").value;
        const speed = document.getElementById("newSpeed").value;

        const res = await fetch(baseUrl, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ name, type1, hp, attack, defense, speed })
        });
        const text = await res.text();
        showResult("âœ… ë“±ë¡ ì™„ë£Œ: " + text);
        fetchPokemonList();
      }

      // ê³µê²©
      async function attackPokemon() {
        const attackerId = document.getElementById("attackerId").value;
        const defenderId = document.getElementById("defenderId").value;
        const res = await fetch(`${baseUrl}/${attackerId}/attack/${defenderId}`, {
          method: "POST"
        });
        const text = await res.text();
        showResult("âš”ï¸ ê³µê²© ê²°ê³¼: " + text);
        fetchPokemonList();
      }

      // ì‚­ì œ
      async function deletePokemon() {
        const id = document.getElementById("deleteId").value;
        const res = await fetch(`${baseUrl}/${id}`, { method: "DELETE" });
        const text = await res.text();
        showResult("ğŸ—‘ï¸ ì‚­ì œ ê²°ê³¼: " + text);
        fetchPokemonList();
      }

      // ê²°ê³¼ ë©”ì‹œì§€ ì¶œë ¥
      function showResult(msg) {
        document.getElementById("resultArea").textContent = msg;
      }

      window.onload = fetchPokemonList;
    </script>
</body>
</html>
